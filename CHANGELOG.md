# 更新日志

## 2023

### 9-5 v0.1.8.4

- 完成插件移植工作

### 9-4 v0.1.8.4

- 更新插件 `admin` `bilibili` `bing` `pigeon` 其他的还没移植完成(在`plugins1`文件夹内)

### 8-31 v0.1.8.4

- 支持库 `logger` 修改使用方法 原方法锁定输出插件名为 `SYSTEM`
- 移除支持库 `crontab`
- 更新依赖

### 8-30 v0.1.8.4

- 重写优化加载插件和加载配置的逻辑
- 规范所有框架的配置文件格式为 `jsonc`

### 8-28 v0.1.8.3

- 修复函数 `retryAsync` 未收到返回值时报错
- 添加支持库 `crontab` 支援错误的当前插件名称(因为是框架是异步的,还是可能会输出错误的插件名,输出的插件名仅供参考!)

### 8-26 v0.1.8.2

- 优化插件 `setu`
- 优化支持库 `fetch` 为函数 `retryAsync` 添加手动停止功能

### 8-26 v0.1.8.1

- 修复插件 `freegames` `bilibili`

### 8-21 v0.1.8

- 修复错误的版本号导致崩溃

### 08-20 v0.1.7.9 -> v0.1.8

- 修复插件 `block` 无法封锁 `notice` 事件

### 08-17 v0.1.7.9

- 修复错误的合并转发
- 修复返回 `quit` 时无法正确的结束处理

### 08-13 v0.1.7.8

- 修复错误的对 `emoji` 反编码处理
- 修正所有 `jsDoc` 类型错误的标注 😭😭😭
- 尝试修复插件 `setu` 有的时候图片获取失败的问题
- 增大 `nodejs` 默认可用内存大小
- 新增启动选项 `pref` 用于统计运行性能情况

### 08-12 v0.1.7.7

- 修复插件 `setu` 错误的插入新用户
- 修正插件 `zaoabo` 错误的提示信息

### 08-12 v0.1.7.6

- 修复连接 `websocket` 失败超过次数后无法退出运行
- 函数 `retryAsync` 添加失败后 sleep 时间
- 支持库 `sendMsg` 新增 `emoji` 转换
- 修复插件 `zaobao`
- 优化插件 `searchImage` 中合并转发中机器人的信息
- 修复插件 `redPacket`
- 修复日志无法记录对象

### 08-11 v0.1.7.5

- 修复插件在加载时缺少 `manifest` 时错误的处理
- 添加配置加载时将数据添加到全局变量中
- ~~新增插件 `refeshConfig`~~ 鸽了
- 修复错误的 `emoji` 处理，现在将处理添加到源头处理
- 优化插件 `help` 可以设置仅管理员可见命令
- 修复插件 `searchImage`

### 08-11 v0.1.7.4

- 新增插件 `block`
- 修复插件 `corpus`
- 更新插件 `searchImage` 依赖

### 08-09 v0.1.7.3

- 修复插件 `setu` 的发送失败依然自动撤回的问题
- 去除一个废弃接口，修复接口不存在的 bug

### 08-09 v0.1.7.2

- 优化插件 `corpus` `searchImage`
- 修复日志记录

### 08-06 v0.1.7.1

- 修复插件 `nbnhhsh` 错误的有效判断

### 08-06 v0.1.7

- 修复支持库 `Api` 中错误的参数使用
- 优化支持库 `eventReg` `fetch` `loadPlugin` `logger` `sendMsg` 中的逻辑
- 更新依赖
- 更新插件 `bilibili` `bot`
- 调整 `init` 中时区设置的顺序

### 08-05 v0.1.6

- 修复插件 `setu` 的错误的重置次数
- 把 `dev` 和 `debug` 模式分离
- 优化日志记录细节功能
- 优化文件下载时的自动后缀
- 修复插件 `searchImage` 错误的鸽子返还
- 更新依赖
- 重写大量 `trycatch` 优化日志
- 新增插件名称显示

### 08-04 v0.1.5.1

- 修复插件 `setu` 错误的 `logger`
- 修复日志记录如果文件夹不存在时无法正常操作

### 08-04 v0.1.5

- 新增日志记录功能

### 08-03 v0.1.4.8

- 修复插件 `zaobao` 日期可能错误的问题

### 07-26 v0.1.4.7

- 修复插件 `gugu`

### 07-24 v0.1.4.7

- 优化插件在失败后的输出日志

### 07-15 v0.1.4.6

- 修复插件 `searchImage` 失败归还鸽子数有误
- ~~已知错误: 使用 `jimp` 剪切 `gif` 时返回的 `base64` 是错误的 [详细信息](https://github.com/jimp-dev/jimp/pull/1239) 等待合并~~ 7 月 28 日已合并

### 07-15 v0.1.4.5

- 修复插件 `redPacket` 名称显示错误

### 07-15 v0.1.4.4

- 修复加载插件时错误的输出

### 07-15 v0.1.4.3

- 修复插件 `help`

### 07-15 v0.1.4.2

- 优化插件加载信息的性能(其实微乎其微)

### 07-14 v0.1.4.1

- 优化插件 `bing` 的回复信息

### 07-06 v0.1.4

- 优化插件
- 修复 `missingParas` 方法错误的识别命令名称
- 新增 `fs` 支持库

### 07-06 v0.1.3

- 新增插件 `setu` `searchImage`
- 优化支持库 `fetch` 可以自定义 `headers` 变量
- 跟随上游 [ChatSydney-FastAPI](https://github.com/huankong233/ChatSydney-FastAPI) 更新密码功能

### 07-05 v0.1.2

- 移植了插件 `dog` `music163` `mute` `nbnhhsh` `prprme` `redPacket` `repeat` `russian` `update` `vits` `zaobao`
- 新增一个方法 `missingParams` 用于格式化输出缺少参数的提醒 位于 `/lib/eventReg.js`
- 新增一个方法 `randomFloat` 用于随机浮点数 位于 `/lib/random.js`
- 优化了 `/lib/sendMsg.js` 中调试时的部分描述
- 修复错误的异步操作

### 07-05 v0.1.1

- 修复插件 `freegames` `steam` 的限免购买链接

### 07-04 v0.1.1

- 取消对 `python` 的支持
- 插件 `epicgames` 改版为 `freegames` 支持了 `steam` 的限免
- 新增插件 `help` `mute` `poke`
- 新增 `api` 支持库,用于对部分接口进行封装

### 07-03 v0.1.0-dev

- 优化现有插件的依赖关系
- 移植两个插件( `epicgames` `dinggong` )
- 修改 `manifest.json` 中 两个不合理的字段名
- 新增 `sleep` 支持库
- 优化 `sendMsg` 支持库 开发模式中会输出发送了哪些消息以及 `stack`
- 优化 `publish.js`

### 07-03 v0.1.0-dev

- 修复插件 `bot` 异步堵塞缺少的判断

### 07-02 v0.1.0-dev

- 恢复 docker 支持

### 07-02 v0.1.0-dev

- 使用启动命令来控制是否启用开发模式
- 优化插件依赖
- 调整配置加载方法
- 增加自动加载插件配置文件

### 07-01 v0.1.0-dev

- 修复插件 `bing` 的 `websocket` 接口最后需要 `/` 的 `bug`
- 修改框架/插件版本判断的逻辑
- 修改支持库 `logger` 去除小写形式
- 修正部分错误的注释和类型

### 07-01 v0.1.0-dev

- 修复支持库 `fetch` 请求时的报错捕获
- 修复支持库 `bot` 调试模式信息输出有误
- 优化支持库 `loadPlugin`
- 跟随上游修改插件 `bilibili`

### 06-29 v0.1.0-dev

- 修复一个命令格式化的 bug
- 移植插件 `corpus`
- 插件 `manifest.json` 文件中新增项 `depends` 用于需要前置插件

### 06-29 v0.1.0-dev

- 优化 `fetch` 库,默认开启重试请求
- 弃用 `yarn` 改用性能更好的 `pnpm`

### 06-28 v0.1.0-dev

- 支持异步堵塞机器人连接(防止还没连上就加载插件)

### 06-26 v0.1.0-dev

- 重写底层框架
- 细化插件系统

### 06-21 v0.0.7.1

- 去除多余的反转义

### 06-21 v0.0.7.0

- 完成更新插件`searchImage`

### 06-20 v0.0.6.5

- 跟随上游`ImageSearcher`包更新插件`searchImage`
- 禁用`yandex`搜图，等待有过机器验证的方法

### 06-20 v0.0.6.5

- 命令不会触发插件`bing`

### 06-20 v0.0.6.4

- 部分插件在调试模式不启用
- 增加插件`zaobao`

### 06-14 v0.0.6.3

- 修复部分插件的错误补偿
- 插件`vits`添加鸽子消耗

### 06-13 v0.0.6.2

- 插件`vits`基本完工

### 06-12 v0.0.6.1

- 优化多处细节，详见 commit
- 插件`vits`暂未完工

### 06-11 v0.0.6

- 优化多处细节，详见 commit

### 06-11 v0.0.5.6

- 修复插件`bing`的错误报错

### 05-24 v0.0.5.5

- 优化插件`bing`加入清空 context 选项

### 05-23 v0.0.5.4

- 修复插件`bing`更换协议出现的 bug

### 05-23 v0.0.5.3

- 修复插件`bing`超时问题，协议转用`websocket`服务端需要配合修改

### 05-15 v0.0.5.2

- 完善插件`bing`
- 默认关闭插件`chatgpt`

### 05-14 v0.0.5

- 新增插件`bing`(完成情况:30%)
- 修复一个错误的鸽子扣除()

### 05-06 v0.0.4.1

- 优化插件`chatgpt`
- 更新所有依赖包

### 05-05 v0.0.4

- 优化插件`chatgpt`

### 05-05 v0.0.3.25

- 新增插件`chatgpt`

### 05-05 v0.0.3.24

- 修复了`transfer`插件数字转义的问题

### 04-02 v0.0.3.23

- 修复了一下`setu`插件失败后撤回的顺序问题

### 04-02 v0.0.3.22

- 照抄更新了一下[无法搜索 Electron QQ 发出的图片的问题](https://github.com/Tsuk1ko/cq-picsearcher-bot/commit/56594b67c16faa64ad32f5bbcb66d73d01476dd1)

### 04-02 v0.0.3.21

- 优化插件`simpleApiCall`接口获取失败的捕获

### 03-29 v0.0.3.20

- 优化插件`update`逻辑

### 03-26 v0.0.3.19

- 修复插件`update`变量错误

### 02-10 v0.0.3.18

- 优化插件`setu`的默认配置的正则

### 02-08 v0.0.3.17

- 优化插件`repeat`的一个细节，不复读命令

### 01-28 v0.0.3.16

- 优化插件`admin`中的一个小细节，群友退群后不显示 qq 号，改为 qq 名称

### 01-26 v0.0.3.15

- 更新`image_searcher`包，完成适配，增强 yandex 成功率(需要手动添加 cookie)

### 01-22 v0.0.3.14

- 新增插件`proxy`支持进行全局代理
- 如果你代理给力则完全不需要使用色图的代理服务器（Tip）
- 解决插件`update`的一个小问题

### 01-21 v0.0.3.13

- 上次给机器人修 bug，色图插件把我 b 站直播间永封了，悲
- 色图支持指定代理服务器了，顺便细分了可能出现问题的部分代码

### 01-18 v0.0.3.12

- 修复插件`simpleApiCall`中舔狗日记的格式转换错误
- 优化插件`searchImage`是否使用反代的功能
- 修复插件`setu`（按道理来说）

### 01-15 v0.0.3.11

- 修复插件`bilibili`中`artice`组件的遗漏 bug

### 01-14 v0.0.3.10

- 修复插件`searchImage`中的`image_searcher`包中的反代服务器爆炸而导致的问题，暂时可能导致部分国内地区 ascii2d 搜图无法使用，会被 cloudflare 拦截下来，大部分国外用户正常~

### 01-12 v0.0.3.9

- 增加对时区的控制(控制代码:`/src/bot`,配置文件:`/config/bot.jsonc`)

### 01-12 v0.0.3.8

- 对插件`update`进行了小调整(格式统一)
- 修复插件`corpus`的转意 bug
- 新增插件`epic`可以输出当日免费游戏

### 01-12 v0.0.3.7

- 对插件`update`进行了小调整(在提醒过后的隔天会重新开启检查更新，嫌烦可以在设置里关闭)
- 对插件`searchImage`的重试次数添加配置

### 01-12 v0.0.3.6

- 对插件中代码进行了格式化(我喜欢的风格 XD)
- 修复插件`corpus`的换行问题，支持图片作为触发词

### 01-09 v0.0.3.5

- 去除插件`searchImage`的强制反和谐，只有 e-hentai 会强制反和谐了，不知道是我的问题还是什么，貌似全部转为 base64 后无法正常发送出去，默认进行 10 次尝试

### 01-09 v0.0.3.4

- 修复支持库`url`的问题

### 01-09 v0.0.3.3

- 优化插件`btSearch`

### 01-09 v0.0.3.2

- 更新插件`simpleApiCall`可以深夜哭哭了
- 新增插件`btSearch`
- 更新插件`phlogo`消耗鸽子咯

### 01-09 v0.0.3.1

- 修复插件`imageSearch`的优化后 bug

### 01-09 v0.0.3

- ~~增加插件`luxun`鲁迅说~~（已删除，优化好了重新上传）

### 01-09 v0.0.2.9

- 修复插件`poke`缺少的判断
- 优化插件`update`的手动检测

### 01-09 v0.0.2.8

- 修复插件`update`版本比较有误的问题

### 01-09 v0.0.2.7

- 修改插件`mute`的功能
- 修改插件`repeat`复读的默认概率以及实现方法
- 修改插件`phlogo`的字体存放路径
- 新增插件`dinggong`实现钉宫语录(需要 ffmpeg 支持)
- 新增插件`poke`实现戳一戳回复

### 01-09 v0.0.2.6

- 修复插件`mute`的全局变量 bug
- 新增插件`admin`用于管理加群/好友等操作,可以在配置文件中设置自动同意还有通知

### 01-09 v0.0.2.5

- 整理代码源码
- 解决部分潜在的异步问题

### 01-09 v0.0.2.4

- 去除不必要的模块

### 01-08 v0.0.2.3

- 对更新提醒功能进行优化，不会造成请求失败依然请求的问题

### 01-08 v0.0.2.2

- 对搜图的所有链接进行强行替换
- 对搜图的预览图进行混淆
- 完全支持对机器人的名字更换，应该(bushi
- 支持更新提醒，可关闭

### 01-06 v0.0.2

- 修复无数 bug
- 添加无数功能
- 支持 Docker 一键部署
- 跟随[image_searcher](https://github.com/huankong233/ImageSearcher)版本更新，进行一定修改，增加了 yandex 支持，parse 函数更具有可读性
- 解决遗留问题，正式支持 node19 等高版本

## 2022

### 11-25 v0.0.1

- 初 版
- 使用自写框架开始编写
